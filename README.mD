# Invoice Extraction API ğŸ“„ğŸš€

**DescriÃ§Ã£o:**  
API desenvolvida para realizar extraÃ§Ã£o automatizada de informaÃ§Ãµes de documentos em PDF, como nÃºmero de nota fiscal, datas e valores.  
A extraÃ§Ã£o Ã© feita por meio de expressÃµes regulares (Regex) e processamento adicional, com a saÃ­da estruturada em formato .xlsx, pronta para integraÃ§Ã£o com fluxos automatizados.

Essa API foi pensada para ser acionada automaticamente via **Power Automate**, a partir de eventos que detectam a necessidade de registrar documentos fiscais (AP - Accounts Payable).  
Ela documenta os principais pontos de uma invoice/documento fiscal nacional (Brasil), extraindo informaÃ§Ãµes relevantes e entregando-as de forma organizada.

---

## âœ¨ Objetivos
- Automatizar a extraÃ§Ã£o de dados crÃ­ticos de documentos financeiros.
- Facilitar a integraÃ§Ã£o com sistemas de RPA (ex: UiPath, Power Automate).
- Reduzir tempo manual de anÃ¡lise de documentos.
- Disponibilizar os dados extraÃ­dos em formato estruturado (.xlsx).
- Tornar o processo totalmente adaptÃ¡vel a fluxos automatizados de negÃ³cios.

---

## âš™ï¸ Tecnologias Utilizadas
- Python 3.11
- Flask (para futura transformaÃ§Ã£o em API web, se necessÃ¡rio)
- PyMuPDF (`fitz`) para leitura de PDFs
- ExpressÃµes Regulares (Regex) para interpretaÃ§Ã£o textual
- Virtualenv para gerenciamento de ambiente
- Power Automate para automaÃ§Ã£o do fluxo de entrada
- JIRA para acompanhamento de backlog (equipe de RPA)

---

## ğŸ› ï¸ Como Funciona a API (VisÃ£o Geral)

1. **Power Automate** detecta necessidade de processar um arquivo de Accounts Payable (AP).
2. **Chamada para a API** (acionamento do `app.py`).
3. O `app.py` orquestra a extraÃ§Ã£o chamando o mÃ³dulo `extract_data.py`.
4. O `extract_data.py` utiliza expressÃµes regulares para capturar:
   - NÃºmero do Documento (Invoice ID)
   - Datas de emissÃ£o
   - Valores monetÃ¡rios
5. Esses dados sÃ£o refinados e armazenados em variÃ¡veis controladas.
6. O mÃ³dulo `AP_structuring.py` (em fase de integraÃ§Ã£o) serÃ¡ responsÃ¡vel por receber essas variÃ¡veis e montar a estrutura final.
7. A estrutura Ã© gravada no arquivo `.xlsx` dentro da pasta `/output`.
8. O resultado final Ã© retornado no fluxo original, dentro do Power Automate.

---

## ğŸ—‚ Estrutura do Projeto

invoice-api/ â”œâ”€â”€ app.py # Script principal (orquestrador da API) â”œâ”€â”€ extract_data.py # FunÃ§Ãµes de extraÃ§Ã£o de dados por Regex â”œâ”€â”€ AP_structuring.py # (Em desenvolvimento) OrganizaÃ§Ã£o dos dados extraÃ­dos â”œâ”€â”€ test_extract_data.py # Scripts de teste da extraÃ§Ã£o â”œâ”€â”€ output/ â”‚ â””â”€â”€ documentacao_AP.xlsx # Planilha de saÃ­da para controle de contas â”œâ”€â”€ doc/ â”‚ â””â”€â”€ README.md â”‚ â””â”€â”€ requisitos.txt â”œâ”€â”€ venv/ # Ambiente virtual Python â””â”€â”€ pycache/ # Cache interno do Python

---
## ğŸš€ Como Rodar o Projeto

1. Clone o RepositÃ³rio:
   ```bash
   git clone https://github.com/seu-usuario/invoice-api.git
   cd invoice-api

2. Ative o Ambiente Virtual:

# Windows
.\venv\Scripts\activate

3. Instale as DepÃªndencias:

pip install -r doc/requisitos.txt

4. Execute a API

python app.py

## ğŸ“¥ Exemplo de Entrada (PDF)
Arquivo PDF contendo informaÃ§Ãµes como:

Nota Fiscal: AB-12345
Data de EmissÃ£o: 25/04/2025
Valor: R$ 1.250,00

## ğŸ“¤ Exemplo de SaÃ­da
Arquivo documentacao_AP.xlsx preenchido automaticamente com:

NÃºmero do Documento	Data de EmissÃ£o	Valor
AB-12345	25/04/2025	1250,00

## ğŸ” Sobre a DocumentaÃ§Ã£o
Cada funÃ§Ã£o e mÃ³dulo contÃ©m:

Docstring explicativa

Tipagem explÃ­cita dos parÃ¢metros e retornos

ComentÃ¡rios tÃ©cnicos para pontos-chave do processo

Exemplos prÃ¡ticos em test_extract_data.py

## ğŸ“‹ BackLog
As tarefas estÃ£o divididas de acordo com o mÃ³dulo responsÃ¡vel (API principal, extraÃ§Ã£o, estruturaÃ§Ã£o).

Cada feature Ã© documentada no backlog para rastreamento de progresso (parte de RPA).

A integraÃ§Ã£o visa suportar automaÃ§Ãµes robustas e confiÃ¡veis.

## ğŸ“£ ObservaÃ§Ã£o Final
Este projeto Ã© parte de uma iniciativa para otimizar fluxos documentais e consolidar boas prÃ¡ticas de extraÃ§Ã£o de dados via pipelines automatizados, sendo uma base sÃ³lida para integraÃ§Ãµes futuras com APIs REST ou bots de automaÃ§Ã£o.